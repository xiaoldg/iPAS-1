
# 認證、授權與存取控制
```
1.存取控制
  1.1存取控制的基本需求
  1.2存取控制的主要概念
  1.3存取控制的類別
  1.4存取控制的威脅
  1.5實體與虛擬的威脅
  1.6系統存取控制
2.身分認證
  2.1身份
  2.2身分認證的方法
  2.3 Kerberos 
  2.4 同步電子代符
  2.5智慧卡
  2.6智慧卡攻擊 
  2.7生物特徵認證
     2.7.1靜態生物特徵
     2.7.2動態生物特徵
3.資料存取控制
  3.1強制存取控制
  3.2任意存取控制
  3.3存取控制目錄
  3.4規則基準存取控制
  3.5角色基準存取控制
4.稽核
  4.1稽核追蹤
  4.2入侵偵測系統
  4.3滲透測試

```

## 1.存取控制
### 1.1存取控制的基本需求
```
安全性
可用性
擴展性
```
### 1.2存取控制的主要概念
```
責任分擔 (separation of duties)
最低權限 (least privilege)
知的必要性 (need-to-know)
資訊分類 (information classification)
```
### 1.3存取控制的類別
```
預防性
偵測性
指導性
嚇阻性
復原性
```
### 1.4存取控制的威脅
```
拒絕服務 (denial of service)
緩衝區溢位 (buffer overflow)
惡意程式 (malware)
密碼破解 (password cracker)
欺騙 (spoofing)
中間監看 (sniffer)
垃圾搜尋 (dumpster diving)
窺視 (shoulder surfing)
未經授權之資料探勘 (unauthorized data mining)
電子訊號外洩 (emanation)
物件重用 (object reuse)
資料剩磁 (data remanence)
```
### 1.5實體與虛擬的威脅
```
偷竊
入侵
社交工程
```
### 1.6系統存取控制
```
身分
身分認證
授權
責任歸屬
```
## 2.身分認證
### 2.1身份
```
電子世界中「身分」的類型：
   使用者名稱 (username)，
   各種電子識別證、智慧卡、提款卡等，
   銀行的帳戶號碼 (account number) 等，
   將在後面細談的生物特徵 (biometrics) 也是一種電子身分。
身分應有以下特性：
   在一個存取控制系統中，每位使用者的身分應為唯一。有助於身分認證的進行與責任歸屬的釐清。
   身分資料應保持最新，離職員工或已不使用的身分應立刻刪除。
   機構內應有選定使用者名稱的政策，以免重複使用或在名稱上洩漏太多訊息。
```
### 2.2身分認證的方法
```
所知之事
所持之物
所具之形
```
### 2.3 Kerberos 
```
它是麻省理工學院所開發的自由軟體，微軟、思科、蘋果等公司都曾使用在其產品中，包括 Windows, Mac OS X, Apache等。
Kerberos 協定建構於對稱式金鑰系統 (於第七章說明)，並需要「信任第三者」。進階的 Kerberos 可以在一些步驟中使用公開金鑰。
它的信任第三者稱為 Key Distribution Center (KDC)，包括兩部分：Authentication Server (AS) 與 Ticket Granting Server (TGS)。
Kerberos 以票證 (ticket) 為基礎，做為使用者身分的憑證。
KDC 擁有網路上密鑰的完整資料庫。而其它成員 (客戶或伺服端) 則只擁有自己的密鑰。
當網路內任何兩者需要對話時，則由KDC完成身分認證後，發出一個會談金鑰 (session key) 供兩端進行安全通訊。
```
### 2.4 同步電子代符
```
同步電子代符 (synchronous token) 可以自動產生單次密碼，然而隨身攜帶的電子代符必須與身分認證伺服器之間保持同步，方法包括：
   時間基準同步：電子代符與身分認證伺服器之間保持精準的時間同步，因此在同一個時間，
   電子代符上顯示的數字 (亦即使用者的單次通關密碼) 與伺服器裡的認證數字相同。
    事件基準同步：電子代符每產生一次密碼，代符與伺服器的數字就會同步變更一次。
   但若代符產生密碼卻未被使用於系統登入，則代符與伺服器間就會失去同步；此時使用者需要對電腦輸入PIN後，讓兩者重新同步。
```
### 2.5智慧卡
```
智慧卡 (smart card) 將晶片嵌入塑膠卡中，是最方便攜帶的電子身分認證工具。智慧卡可分為以下類別：
   接觸式智慧卡 (contact smart cards)：包括塑膠卡身、晶片、與金屬接觸介面。卡片要插入讀卡機內，
   讓智慧卡晶片裡的微處理器與電腦或伺服器建立通訊。目前台灣的金融卡都是接觸式智慧卡。
   
   非接觸式智慧卡 (contactless cards)：類似接觸式智慧卡，但是介面不是金屬接觸層，而是無線射頻(RF)。
   非接觸式智慧卡使用更為方便，台北捷運悠遊卡即為一例。接觸與非接觸式智慧卡本身都沒有電源，要靠讀卡機以接觸或非接觸方式傳輸電力。
   
   兩用智慧卡 (combi-cards)：是指同一張卡有接觸與非接觸式兩種介面，部分金融卡與悠遊卡結合成一張聯名卡，就具備兩種介面。

智慧卡攜帶方便，可以在不增加使用者負擔的情況下做到「雙重要素認證 (two-factor authentication)」，
最常用的雙重要素認證是智慧卡結合通關密碼或 PIN。有較先進的安全系統已將使用者的指紋資料存入智慧卡中，做到三重要素認證。
智慧卡可以儲存人腦無法記憶的密碼長度，因此，使用者只要記得智慧卡的 PIN，就可以讓智慧卡去記多組冗長的密碼。
萬一智慧卡遭竊，大部分智慧卡都設計成三次 PIN 輸入錯誤則永遠鎖卡。
有些智慧卡具備公開金鑰 (public key) 的運算能力，如此能讓使用者隨身攜帶電子憑證，
執行安全性極高的PKI運算；同時也可以做電子簽章，讓交易具備不可否認性 (non-repudiation)。
```
### 2.6智慧卡攻擊 
```
智慧卡技術已被使用二十年以上，許多攻擊方式應運而生。以下是一些常被討論的方法：
實體侵入式攻擊 (physical invasive attacks)
   精密儀器可將晶片電路清晰放大，並以探針搭接在要讀取的金屬接點上，這個作法稱為 micro-probing，
   可直接讀取記憶體內資料，或用以瞭解加密引擎的設計方法。
   
旁道攻擊 (side-channel attacks)
   攻擊者在智慧卡正常運作時，輸入特定數值讓晶片計算 (尤其是加解密)，再統計該計算所使用的時間或計算過程中所消耗的電力。
   如果統計樣本夠大，就有機會推算出晶片內可能的金鑰密碼。
   較有名的旁道攻擊法為 timing attack 與 power attack 等。
   
操弄攻擊 (manipulative attacks)
   攻擊者刻意在智慧卡運算環境中加入變數，使軟硬體發生非預期的亂象。若這些亂象不是智慧卡設計者所考慮到的，攻擊者就有可能取得機密資料。
   例如每當智慧卡在做 PIN 的認證時，攻擊者就刻意升高或降低電壓，使CPU無法完成認證程序。
   如果智慧卡程式設計為 default true，攻擊者就能通過認證。
假設智慧卡執行以下程式(以虛擬程式碼表示)，允許將EEPROM記憶體中位址101到110的十比資料輸出到卡外。

    i = 101;
10  IF ( i > 110 ) GOTO 12
    OUTPUT( mem [i] );
    i = i + 1;
    GOTO 10
12  EXIT	

【操弄攻擊】觀察以上程式，執行 “IF ( i > 110 ) GOTO 12” 這行指令所需花費的時間比其它指令都長，
因為它做一個判斷(i 是否大於110?)之後，還要執行跳行 (GOTO 12)。若攻擊者故意將智慧卡的時鐘頻率(clock rate)調高，
例如從標準的5MHz調升到10MHz，這行指令就無法在一個時鐘週期 (clock cycle)內完成：
也許只做了判斷卻沒有完成跳行，因此永遠離不開循環 (loop)；i 的值會繼續往上增加，因此記憶體中所有的資料都被輸出卡外。
```
### 2.7生物特徵認證
```
生物特徵是 something you are, 也是三種認證要素中最難被偽造者。它可以同時兼具「身分」與「認證」的功能。
生物特徵有靜態與動態兩種：
   靜態者包括指紋、視網膜等身體特徵。
   動態者包括聲音、簽字律動等行為特徵。
採用生物特徵辨識系統時應注意以下事項：
   測量應該準確，下一頁將介紹 CER 概念，用以量測準確度。
   一些生物特徵辨識系統可能遭到使用者抗拒，例如視網膜掃描等。
   有的生物特徵辨識過程需要較長時間，以致未必實用。目前還是指紋辨識的技術較為成熟。
   
當儀器的靈敏度被訂越高，越多對的東西會被誤判為錯(誤殺)，稱為第一類錯誤。
當儀器的靈敏度被訂越低，越多錯的東西會被誤判為對(誤放)，稱為第二類錯誤。
最佳的儀器靈敏度應該在兩條曲線的交點，這個點的錯誤率稱做交點錯誤率 (crossover error rate, CER) 。
```
### 2.7.1靜態生物特徵
```
指紋、掌紋
手掌結構
視網膜(retina)掃描
虹膜(iris)掃描
```
### 2.7.2動態生物特徵
```
聲音模式
臉部辨識
敲鍵盤律動
簽字律動
```
## 3.資料存取控制
```
強制存取控制 (mandatory access control, MAC)
任意存取控制 (discretionary access control, DAC)
存取控制目錄 (access control list, ACL)
規則基準存取控制 (rule-based access control)
角色基準存取控制 (role-based access control)
```
### 3.1強制存取控制
```
強制存取控制是最嚴格的資料存取控制手段，它對主體 (subject) 及物件 (object) 都清楚的劃分安全等級，符合等級者方得存取。
   「主體」是指使用者或客戶端主機等，能發出存取需求者；「物件」是指伺服器、資料庫、檔案等被存取者。
   機密等級標籤 (sensitivity labels) 常被用來標示主體與物件的安全等級。
   例如我國國家機密區分為「絕對機密」、「極機密」、「機密」三個等級，一般公務機密則列為「密」等級。
   強制存取控制的系統會比對主體與物件之間的安全等級，來決定是否同意資料存取之要求。
   除此之外，該物件的「所有人 (owner)」也可以依照「知的必要性 (need-to-know)」來否決一些安全等級符合者之存取要求。
   並非所有等級符合者都有存取該項機密物件的必要。
```
### 3.2任意存取控制
```
「任意」是指相對於強制存取控制較不嚴格，但仍有一定之資料存取控制的方式。
   任意存取控制必須具備一些一致的規定，以控制或限制主體對物件的存取。這種存取權力是基於「知的必要性 (need-to-know)」。
   在實作上，會由該物件的「所有人 (owner)」或他所指定的代理人來決定那些主體有權存取該物件。
   這種存取控制較不嚴格：如果一個主體有某些權利，他可以把這種權利轉給另外的主體。
   例如在任意存取控制的環境下，總經理可以讓他的秘書代讀電子郵件；但在強制存取控制的環境下，這是不被允許的。
```
### 3.3存取控制目錄
```
存取控制目錄 (ACL) 是最常見的任意存取控制的一種建置方式。
ACL 將使用者是否被允許存取每個物件以條列方式展開，並對權限作限制。
```
### 3.4規則基準存取控制
```
規則基準存取控制是另一種任意存取控制的建置方式。

ACL是條列主體對每個物件的存取權限；而規則基準存取控制則是藉由一套規則，來決定那些存取要求該被允許而哪些該被拒絕。
例如，有一條規則可能是：只有通過財務訓練的同仁可以存取庫存系統。Bob 尚未接受訓練，他自然無法存取該系統。
```
### 3.5角色基準存取控制
```
角色基準存取控制與前面討論的規則基準類似，只是角色基準的存取規則是以使用者在組織內的角色為基準。
   例如，只有財務與庫房同仁可以存取庫存系統，而Alice是財務課長，所以他可以存取該系統。但下周他高升會計經理，就無法再存取庫存系統了。
角色基準存取控制是一種任意存取控制的建置方式；但也可應用於強制存取控制。
   角色基準的強制存取控制也要對主體與物件做清楚的安全等級劃分與比對；但主體是「角色」而非一般所謂的使用者。
角色基準存取控制最大優勢是能與組織內的結構與階級維持一致的關係，對組織變動的反應最快速。
```
## 4.稽核
### 4.1稽核追蹤
```
稽核追蹤 (audit trail) 是確保存取控制的重要方式。
稽核追蹤依時間性記錄系統上的所有活動，藉由對系列活動的重整與判讀，就能找出可能的入侵行為或其他資訊安全事件。
記錄資料應包括系統、網路、應用程式、與使用者的各種活動。
記錄資料可用來警告可疑的事件，分析入侵的行為，並可用於電子犯罪調查甚至當作法庭證據。
記錄資料量通常極大，遠超過系統管理員所能判讀，因此需要設定一些過濾機制。
應該有嚴格的控管，避免稽核追蹤記錄被竄改。
自動化的稽核追蹤工具很多，價格差異也很大，應該選擇最適合需要的工具，並因應稽核目的做適當調整。
```
### 4.2入侵偵測系統
```
入侵偵測系統 (intrusion detection systems, IDS) 可以即時監控系統或網路，並偵測可能的入侵行為。
   IDS 常以「稽核追蹤記錄」與「網路流量資訊」做為即時分析數據。
   當 IDS 偵測到入侵行為時，他有主動或被動的做法：
       主動做法：1. 主動收集更多入侵者資料；2. 切斷入侵者連線；3. 主動反擊入侵者 (不建議這個做法)。
       被動做法：1. 緊急事件的警報；2. 可疑事件的警告；3. 定時的回報。
   入侵防禦系統 (intrusion protection systems, IPS) 比 IDS 更進一步，能在侵入發生時主動防禦系統或網路。
   例如有一個可疑的封包進入網路，IDS會提出警告後讓封包進入，但IPS會在提出警告後攔截封包。
   IPS的風險是一旦誤殺 (第一類錯誤)，反而產生了新的問題。
```
### 4.3滲透測試
```
滲透測試 (penetration test, PT) 是以一套正式的步驟來突破安全控制，並存取應受保護的系統與資料。
它的目的在協助組織瞭解自身的安全漏洞，並演練一旦遭入侵後之標準作業流程。
外部測試時，測試人員扮演一位從外部入侵的駭客。
Zero-knowledge (black box) test 是指進行測試時，專業測試人員完全沒有受測組織的資訊，這種測試在模擬外部駭客的攻擊行為。
Partial-knowledge test 是指測試人員有部分受測組織的資訊，可以縮短滲透測試花費之時間，並集中在較脆弱的部分測試。
內部測試時，測試人員扮演一位內部人員。
Full-knowledge (white box) test: 是指測試人員清楚瞭解受測組織，這種測試在模擬組織內部惡意工作人員的攻擊行為。
```
