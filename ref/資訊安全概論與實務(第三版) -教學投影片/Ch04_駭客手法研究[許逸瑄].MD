# 駭客手法研究
```
1.駭客分類
2.網站安全
  2.1認識網站結構
  2.2網站攻擊步驟
  2.3攻擊網頁伺服器
  2.4攻擊應用程式
  2.5資料隱碼攻擊
  2.6迴避授權認證
  2.7Google Hacking
  2.8認識通關密碼 
  2.9窮舉攻擊法
  2.10字典攻擊法
  2.11彩虹表攻擊法
  2.12通關密碼之政策
3.認識無線通訊技術與弱點
  3.1認識無線區域網路
  3.2 WEP
  3.3無線網路攻擊
  3.4無線網路的竊聽攻擊
  3.5開放身分認證
  3.6欺騙的無線基地台
  3.7無線網路的拒絕服務攻擊
```
## 1.駭客分類
```
黑帽駭客 blackhat hackers 
白帽駭客 whitehat or ethical hackers
灰帽駭客 grayhat hackers
改革的黑帽駭客 reformed blackhat hackers
```
## 2.網站安全
### 2.1認識網站結構
```
瀏覽器 (browsers)：例如 Internet Explorer 或 FireFox 等
通訊協定 (transport protocols)：HTTP 或有加密功能之 SSL
網站伺服器 (web servers)：最常見的為以微軟為主的 IIS 和開放原始碼的 Apache
網站應用 (applications)：有 PHP 與 ASP 較常見。
```
### 2.2網站攻擊步驟
```
掃描網站伺服器:
   駭客常使用合法而免費的工具 (如 Nmap 或 Amap) 來尋找開放的電腦連接埠，或瞭解作業系統等。
   www.netcraft.com 是一個功能極強而不需安裝的工具，在它的 “What‘s that site running?...” 欄打上欲查詢之網站名，即可看到很詳細的網站資訊。
   駭客也會使用簡單的通訊協定 (如 Ping 或 Telnet) 來測試網路結構，例如 Telnet 一個隨意網址，便能收集到以下資訊：
瞭解網站與弱點:
   攻擊者查出網站伺服器的廠牌、型號後，便能進一步尋找該伺服器的已知弱點。
   舉例說明，如果工具 (例如 Netcraft) 指出伺服器為 Microsoft IIS 6.0， 
      則該系統使用 Windows 2003；若為 Microsoft IIS 5.0 則是 Windows 2000。
   攻擊者可以在 www.securityfocus.com 或 http://nvd.nist.gov 等公開網站 找出該系統的已知弱點。
   例如在 SecurityFocus 網頁的 vulnerabilities 輸入 “Microsoft IIS 5.0” 
      就能找到包括 “.printer ISAPI Extension Buffer Overflow” 等弱點，從2000年到2007年共累計76項。
      微軟公司針對每一項弱點都已發行補丁，但若沒有依指示及時安裝補丁，就易成為受攻擊的標的。
```
### 2.3攻擊網頁伺服器
```
網站伺服器偶而會被找出弱點，以下是 IIS 5.0 曾遭受攻擊的兩個弱點：
   緩衝區溢位 (buffer overflow)：2001年IIS 5.0 被發現有 .printer 檔案的緩衝區溢位，
   若連續被塞入420 個以上的字元，緩衝區即滿溢。此時伺服器有可能會回覆給攻擊者一個 prompt，讓他有機會對主機直接下達指令。
   檔案系統橫越 (Unicode directory traversal)：IIS 5.0 對 Unicode 的檢查不夠嚴謹，
   若直接在URL欄填入長Unicode，就可以騙過網站檢查。例如將 ’/’ 這個符號輸入URL欄應該受到檢查，
   但若輸入這個符號的長 Unicode ‘%c0%af’ 就能不被檢查而直接接受。
   這讓 ‘../../../’ (移往根目錄) 這種不該被接受的語句能被插入URL欄，造成安全問題。2001年的 Nimda 蠕蟲就是使用這個 IIS 弱點。
```
### 2.4攻擊應用程式
```
混淆 URL (URL Obfuscation)
   URL 可以填入IP位址，例如 http://192.168.13.10。
   將這四個數字個別展開成8位的二進位數，再接成32位就成為：11000000101010000000110100001010，亦為十進制 3232238858。
   因此，http://3232238858 也會指向同一個網站，但以這種混淆的URL輸入法有時可以騙過網站檢查，讀取一些不被允許的IP。
XSS 是駭客針對網站應用程式漏洞之攻擊手法，將 HTML 或Script插入網頁中，造成其他人看網頁時受到影響。
   完全例如某位惡意的使用者，在一個網站填寫個人資料頁面時包含了以下這段文字：<script>alert(‘This is a pop!’);</script>。
   當別的使用者瀏覽此人的個人資料，就有一個討厭的視窗彈出。
```
### 2.5資料隱碼攻擊
```
部分網站程式將使用者輸入的資料直接交給資料庫處理，而未事先過濾可能有害的字元。
讓駭客有機會在輸入的資料中夾帶 SQL 語言，進行資料隱碼攻擊 (SQL injection)。
此攻擊法並非透過病毒等手段，而是經由標準程序操作；因此為防火牆或防毒軟體所無法防範。唯有加強安全控管並建立良好的程式開發習慣。
資料隱碼攻擊有以下幾種方法
   迴避授權查驗
   使用 SELECT 指令
   使用 INSERT 指令
   使用 SQL Server 程序
```
   
### 2.6迴避授權認證
```
最簡單的資料隱碼攻擊是迴避掉網站的登入首頁。當使用者輸入使用者名稱與密碼後，假設網頁程式用以下SQL將它們與資料庫中 Users 表格做逐行比對，以確定使用者身分。

這時如果駭客做這樣的輸入：
Login: ‘ OR ‘ ‘ = ‘
Password: ‘ OR ‘ ‘ = ‘

則前述之 SQLQuery 將被給予以下之值，由於 ‘’ = ‘’ 永遠為真，所以不需輸入使用者名稱與密碼，仍能通過認證。 


	ELECT 查詢用來從資料庫讀出資料。網站應用程式若提供動態內容，則很可能是直接使用 SELECT 的查詢結果。一種攻擊方法是在 WHERE 子句加上 UNION SELECT。假設網站程式使用以下 SQL：

這時如果駭客做這樣的輸入：
Login: ‘ UNION ALL SELECT OtherField FROM OtherTable WHERE ‘ ‘ = ‘

則前述之 SQLQuery 將被給予以下之值，讓 City = ‘’，所以沒有動作；反而是駭客刻意插入在 UNION 後面的查詢被執行了。 


INSERT 指令將資料加入資料庫內。部分網站會將使用者輸入的資料重新顯示做為確認，這就成為攻擊的機會。假設網站程式要使用者註冊時，使用以下 SQL：

這時如果駭客做這樣的輸入：
Name: ‘ + (SELECT TOP 1 FieldName FROM TableName) + ‘
Email: xyz@xyz.com

因此 SQLString 不再是一個新輸入的名字，而是在資料庫裡的第一筆資料。當網站將使用者輸入的資料重新顯示，反而洩漏了資料。
```
### 2.7Google Hacking
```
搜尋網站 (例如 Google) 的搜尋能力極為強大，往往會把敏感資訊公諸於世。Google hacking 是指使用搜尋引擎的連結侵入他人系統。
Johnny Long 所著：“Google Hacking for Penetration Testers” 介紹許多Google 駭客手法，也可上網站了解：http://johnny.ihackstuff.com。
如果在 Google 打入關鍵字 “Index of /admin” 可讓你連結到一些粗心網站的系統目錄內，而不需經過身分認證。
   打入“Index of /password” 或 “Index of /mail” 會有類似的結果。
   請注意：不可侵入他人系統，以免觸法。
```


### 2.8認識通關密碼
```
使用者名稱 (username) 與通關密碼 (password) 是時下電腦、系統、與網路身分認證最常用的方法。
破解通關密碼的手法不外以下幾種：
   以電腦重複去試各種可能的密碼。
   以社交工程、網路釣魚、或使用中間監看工具來騙取密碼。
   由於許多使用者不願費心記憶密碼，所以用直覺或觀察法也甚為有效，例如：
      可以先試 “1111”, “1234”, “abcd”, “password” 之類的懶人密碼；或是輸入使用者名稱，許多人將這兩者設為相同。
      若有其私人資料，則試其配偶、子女之姓名拼音或生日，或以上合併。
      觀察當下環境裡是否有適合作密碼的字，例如網址、網名、廣告詞等。
```
### 2.9窮舉攻擊法
```
假設通關密碼每個字元有 n 種選擇，而窮舉的密碼長度從 1 算到 i，那麼可能的密碼共有 Sum(n1, n2, …, ni ) 種。
舊式 ATM 規定的 PIN 為四位數字 (n=10, i=4)，共有 11,110 種選擇；現改為八位數之後，選擇增加了一萬倍。
電腦使用標準鍵盤，可以增加 n，例如數字 (n=10)，字母 (n=26)，大小寫分開 (n=26)，鍵盤符號 (n=33)。若以上都用，
則 n=95。假設窮舉所有的八個位數的密碼，則有 6,704,780,954,517,120 種。
經過這樣的分析，我們得到兩點結論：
由於運算時間過長，窮舉攻擊並不適合用來攻擊電腦的通關密碼。
設計通關密碼時，較長的 n 和 i 可以有效的遏阻密碼攻擊。
```
### 2.10字典攻擊法
```
字典攻擊乃基於一個假設：一般人設定的密碼大多可以在字典裡找到，或是可以用其他方法猜測與分類。
這個假設甚為合理，因為幾乎沒有人能記得 (或願意去記) 一個隨機產生的八位元密碼。
網路上有許多字典攻擊工具，其中以 Cain & Abel 與 John the Ripper 較具知名度。
這類工具是把兩刃劍：一方面可能幫助駭客攻擊別人的密碼；另一方面，若整合進身分認證系統，可幫助使用者挑選高強度之密碼。
通關密碼的選擇具有語言及地區性。英語系國家的使用者常選用英文單字；但華人使用者可能使用中文拼音。
例如「小明」的拼音與四聲為：Shiao3Ming2，從英文看這個密碼很強，在台灣則未必。
許多人在研究密碼的規律性；而使用者設密碼時，應避免規律性。
```
### 2.11彩虹表攻擊法
```
一般而言，密碼不會儲存在純文字檔案中，而是用雜湊 (hash) 函數的輸出值來儲存密碼。
雜湊是不可逆運算，即使攻擊者能夠讀取密碼的雜湊表，也不能從雜湊表來重建密碼。
「彩虹表」是針對各種可能的字母組合，預先計算好其雜湊值並列成表格，可以用來攻擊前述的密碼雜湊表。
雖然攻擊者也可以即時計算雜湊值，但是利用這個預先算好的龐大雜湊表，能讓攻擊速度變得極快。
Ophcrack 是彩虹表攻擊發明人Philippe Oechslin 所提供的工具，可有效攻擊 Windows 之通關密碼。
```
### 2.12通關密碼之政策
```
CISSP 建議以下的通關密碼政策：
   至少六個字元長度，應包含數字、大小寫及特殊符號，不應為字典中的單字或與使用者名稱有關連。
   通關密碼需經常更換，並勿重複使用。應訓練使用者如何挑選及保護密碼，包括：不可與人分享密碼，
   避免易被猜中之密碼，並不可將密碼放置於未受保護之處。
每當幾次密碼輸入錯誤，系統可以暫時鎖住該帳戶數分鐘，可有效減低窮舉或字典等攻擊之速度。
在系統計算每個密碼的雜湊函數時，可以額外加入一個密值，讓駭客事先計算或下載的彩虹表失靈。這個作法稱為加鹽 (salted)。
可以在使用者設定新密碼時做簡單的檢查，例如要求輸入的密碼應含有數字、大寫、小寫、與特數符號四者中至少三種。
```
## 3.認識無線通訊技術與弱點
```
家用無線電話：早期（十數年前）家用無線電話沒有安全措施，若與鄰居使用同型機具，就能彼此聽到通話。
目前的無線電話已安全許多，但若有適當的工具，仍然可以空中竊聽。
衛星電視：衛星電視節目經常遭到未付費戶的非法接收。2001年美國衛星電視業者DirectTV使用動態碼結合智慧晶片，
讓十萬台偽造的機上盒一夕之間變成為廢物，情況方得控制。
行動電話：第二代數位電話開始具備加解密功能後，空中竊聽就非常困難；但在電信業者機房依然可以側錄。
藍芽 (Bluetooth)：藍芽有許多安全弱點；Bluejacking攻擊能將資料塞進使用藍芽的機具；Bluesnarfing攻擊能從機具中盜取資料。
```
### 3.1認識無線區域網路
```
	無線區域網路 (wireless LAN or WLAN) 的標準為802.11系列，由IEEE在1997年制定。
	802.11 技術持續在演進中，較常使用的 2.4GHz 標準包括過去的 802.11b (11Mbps) 和現在的 802.11g (54Mbps)。
802.11n 預計在2009年通過標準，傳輸速率可達數百 Mbps，距離也較遠。
	802.11 使用以前軍方的 spread spectrum 技術，可以降低雜訊干擾並且可隨訊號品質調整傳輸速率 (訊號品質好就能提高速率)。
	802.11b/g/n 將頻寬切分為14個互有重疊的通道 (channels)，每個通道距離 5MHz。
但每個國家有不同的頻寬限制，台灣與北美相同只能用11個通道，大部份歐洲國家可以用13個。
```
### 3.2 WEP
```
無線網路比有線網路更難保障傳輸安全，有鑑於此，一種加密傳輸方法 Wired Equivalent Privacy (WEP) 被設計並廣為應用，然而此法已被完全被攻破。
WEP 使用 RC4 對稱式加密法，但裝置的方式有漏洞。
WEP 的初始值 (initialization vector, IV) 會被重複使用，收集夠多的封包後，就可以解開密鑰。
此外，WEP 沒有將整個傳輸加密，表頭和表尾皆為明碼。
Wi-Fi Protected Access (WPA) 被提出以修補 WEP的問題。
WPA 使用修正的 RC4 (TKIP) 並增加金鑰長度，IV 由 24 bit 增至 48 bit；進階的 WPA2 更使用 AES 加密。
```
### 3.3無線網路攻擊
```
竊聽 (eavesdropping)
開放身分認證 (open authentication)
欺騙 (spoofing)
拒絕服務 (denial of service, DoS)
```
### 3.4無線網路的竊聽攻擊
```
竊聽攻擊是無線網路的基本問題，任何在射頻範圍內的機具都可以接收到訊號。
   將無線 NIC 卡設定在隨意模式 (promiscuous mode)，就可以接收所有的封包，而不僅限於自己的IP位址。
   使用強化天線，可以接收更遠的訊號。一個簡易的 cantenna 有機會收到三百公尺外的 WLAN 訊號。
   相當多的無線網路沒有啟動最基本的安全設定，因此被竊聽的資料是以明碼傳輸。而FTP與SMTP等協定在傳輸使用者名稱與通關密碼時，也都是使用明碼。
   如前所述，即使以 WEP 加密傳輸，仍可輕易的以工具破解。
```
### 3.5開放身分認證
```
大部分的無線網路設備 (如基地台) 在出廠時的設定都是 open systems authentication，
也就是不論任何人或系統，都可以不經身分認證地自由使用。許多旅館、咖啡館、餐廳提供的無線網路都處於開放身分認證的狀態。
惡意使用者可以經由這個網路的連結做不法的事，卻隱藏自己的IP。
開放身分認證的狀態讓連結上來的使用者都冒著遭人竊聽的風險。
大部分使用者上網後的第一件事就是查電子郵件，開放身分認證這個狀態讓使用者與郵件伺服器間的ID與密碼被暴露在公共場合。
這種狀態也讓連結上來的主機有被安裝後門的風險。一旦這些被侵入的主機遭受駭客挾持，就可能在未來被用作攻擊別人的傀儡機器 (zombies)。
```
### 3.6欺騙的無線基地台
```
在無線網路世界裡，駭客未必扮演中間攻擊者，也可能是一個基地台，稱做欺騙基地台 (rogue access point) 或孿生惡魔 (evil twin)。
若你在公共場合急著上網，可能會隨意選擇任何能夠上網的無線網路，卻連結到了一個駭客所設置的基地台。
駭客基地台可能取了一個足以亂真的名字，例如 WiFi-Service，假裝成收費網路服務，向使用者要信用卡號及驗證碼。
基地台的角色也讓駭客可以攔截機密資料，如網路銀行密碼等。
有時駭客會在公司附近安裝無線基地台，如果一台公司內的電腦同時連結公司內部有線網路 (intranet)，
又連結了駭客基地台，那麼駭客就有機會經此路徑侵入公司內部網路。
有的WLAN卡會自動連結訊號最強的無線網路，而未徵詢使用者。
```
### 3.7無線網路的拒絕服務攻擊
```
身分認證洪水攻擊 (authentication flood attack) 是指駭客對基地台不斷發出身分認證的要求，
讓認證伺服器無法回應其他使用者的正常要求。
解除授權洪水攻擊 (deauthentication flood attack) 是相反的，由駭客偽裝伺服器，
不斷的向某個使用端電腦發出解除授權信號，該電腦意欲重新連線，則繼續用解除授權來阻斷。
無線干擾攻擊 (network jamming attack) 是使用高能量的電波發送機對預干擾的區域發射，
一台1000瓦的發送機可以在一百公尺外干擾一個小型辦公室的無線網路。
更高功率的電波發送機若以天線對準基地台發射脈衝波，有機會永久性損毀基地台的電子元件。
```
